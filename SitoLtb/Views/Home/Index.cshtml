@{
    ViewData["Title"] = "Home Page";
}
@model SitoLtb.ViewModels.IndexVM

<section class="section-1">
    <img src="~/images/HeroImage.jpg" alt="Chessboard" />
    <div class="hero-copy">
        <h1>Il Libero Torneificio del Borgo</h1>
        <h2>Tutti i mercoledì nella sede in via Bena 10/a e tutti i giovedì presso l'associazione "Comala" puoi partecipare agli eventi del circolo</h2>
        <a class="hero-btn" asp-controller="Home" asp-action="Preiscrizione">Scopri gli eventi</a>

    </div>
</section>

<section class="section-2">
    <div class="slider-wrapper">
        <div class="slider" id="slider">
            @foreach (var post in Model.Posts
            .OrderByDescending(p => p.CreatedDate)
            .Take(10))
            {
                <div class="cards">
                    <a href="@post.ThumbnailUrl" class="card-link">
                        <div class="card">
                            <div class="post-title">@post.Title</div>

                            <div class="post">
                                <img src="@post.ThumbnailUrl" alt="@post.Title" />
                            </div>
                        </div>
                    </a>
                </div>
            }
        </div>
    </div>
</section>



<section class="section-3">
    <h2>Chi siamo</h2>
    <div class="section-3-container">
    <h3>La verdolina</h3>
    <div class="container-div">
            <div class="container1" id="mapVerdolina" aria-label="Mappa Verdolina"></div>
        <div class="container2">mercoledì, è arrivato il momento</div>
    </div>
    </div>
    <div class="section-3-container">
        <h3>Il Comala</h3>
        <div class="container-div">
            <div class="container1" id="mapComala" aria-label="Mappa Comala"></div>
            <div class="container2">mercoledì, è arrivato il momento</div>
        </div>
    </div>
</section>

<section class="section-4">
    <h2>La nostra Galleria</h2>
    <div class="section4-gallery-grid">
        <img class="section4-img-1" src="https://picsum.photos/id/1015/1200/800" alt="Galleria 1" />
        <img class="section4-img-2" src="https://picsum.photos/id/1015/1200/800" alt="Galleria 2" />
        <img class="section4-img-3" src="https://picsum.photos/id/1015/1200/800" alt="Galleria 3" />
        <img class="section4-img-4" src="https://picsum.photos/id/1015/1200/800" alt="Galleria 4" />
        <img class="section4-img-5" src="https://picsum.photos/id/1015/1200/800" alt="Galleria 5" />
        <img class="section4-img-6" src="https://picsum.photos/id/1015/1200/800" alt="Galleria 6" />
    </div>
</section>
<!--
 <section class="section-5">
    <ul>
        <li>
            <img src="https://picsum.photos/id/1016/1200/800" alt="La Verdolina" />
            <span><a asp-controller="Home" asp-action="PreiscrizioneVerdolina">La Verdolina</a></span>
        </li>
        <li>
            <img src="https://picsum.photos/id/1016/1200/800" alt="Comala" />
            <span><a asp-controller="Home" asp-action="PreiscrizioneComala">Comala</a></span>
        </li>
        <li>
            <img src="https://picsum.photos/id/1016/1200/800" alt="Tornei del weekend" />
            <span><a asp-controller="Home" asp-action="PreiscrizioneWeekend">Tornei più seri</a></span>
        </li>
    </ul>
</section>
-->
<section class="section-6">
    <h2>L'offerta didattica LTB</h2>
    <div class="main-div-section-6">
    <div class="image-comparison-slider">
    <img src="~/images/split-test1.jpg" alt="before"/>
    <div class="img-wrapper">
            <img src="~/images/split-test2.jpg" alt="after" />
    </div>
    <span class="label label-before">Before</span>
        <span class="label label-after">After</span>
    <div class="handle">
        <div class="handle-line"></div>
            <div class="handle-circle">
                <i class="fas fa-chevron-left"></i>
                <i class="fas fa-chevron-right"></i>
            </div>
            <div class="handle-line"></div>
    </div>
    </div>
    </div>
</section>

@section Scripts {
    <!--
 
    <script>
        function initMap() {
          const location = { lat:45.073662, lng: 7.622538 };
          const map = new google.maps.Map(document.getElementById('mapVerdolina'), { zoom: 15, center: location });
          new google.maps.Marker({ position: location, map });
        }
    </script>

        <script>
        function initMap2() {
          const location = { lat:45.070484, lng: 7.655718 };
          const map = new google.maps.Map(document.getElementById('mapComala'), { zoom: 15, center: location });
          new google.maps.Marker({ position: location, map });
        }
    </script>
    -->
    <script>
        // Mappa 1 – Verdolina (esempio con coordinate a caso)
            const mapVerdolina = L.map('mapVerdolina').setView([45.073662, 7.622538], 14);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 15
    }).addTo(mapVerdolina);
            L.marker([45.073662,  7.622538]).addTo(mapVerdolina).bindPopup('La Verdolina');
    </script>
    <script>
    // Mappa 2 – Seconda località (es. Torino)
    const mapComala = L.map('mapComala').setView([45.070484, 7.655718], 14);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 15
    }).addTo(mapComala);
            L.marker([45.070484, 7.655718]).addTo(mapComala).bindPopup('Comala');
    </script>


    <script>
        window.addEventListener('load', () => {
            const sliderS2 = document.getElementById('slider');
            if (!sliderS2) return;

            const cards = sliderS2.querySelectorAll('.cards');
            const totalCards = cards.length;
            if (!totalCards) return;

            let index = 0;

            function stepPx() {
                const gap = parseFloat(getComputedStyle(sliderS2).gap) || 0;
                const cardWidth = cards[0].getBoundingClientRect().width;
                return cardWidth + gap;
            }

            setInterval(() => {
                index++;

                sliderS2.style.transition = "transform 0.5s ease-in-out";
                sliderS2.style.transform = `translateX(-${stepPx() * index}px)`;

                if (index >= totalCards) {
                    setTimeout(() => {
                        sliderS2.style.transition = "none";
                        sliderS2.style.transform = "translateX(0)";
                        index = 0;
                    }, 500);
                }
            }, 4000); // ✅ 4 secondi

            window.addEventListener('resize', () => {
                sliderS2.style.transition = "none";
                sliderS2.style.transform = `translateX(-${stepPx() * index}px)`;
            });
        });
    </script>



    <script>
              VanillaTilt.init(document.querySelector(".image-comparison-slider"), {
                max: 7,
                speed: 800,
                scale:1.02,
                glare: true
            });


    const slider = document.querySelector(".image-comparison-slider");
    const sliderImgWrapper = document.querySelector(".image-comparison-slider .img-wrapper");
    const sliderHandle = document.querySelector(".image-comparison-slider .handle");

    slider.addEventListener("mousemove", sliderMouseMove);
    slider.addEventListener("touchmove",sliderMouseMove);

    function sliderMouseMove(event){

        if (isSliderLocked) return;

        const sliderLeftx=slider.offsetLeft;
        const sliderWidth=slider.clientWidth;
        const sliderHandleWidth = sliderHandle.clientWidth;

        let mouseX = (event.clientX || event.touches[0].clientX)- sliderLeftx;

        if (mouseX < 0 ) mouseX=0;
                else if(mouseX > sliderWidth) mouseX= sliderWidth;

           sliderImgWrapper.style.width=`${((1- mouseX/sliderWidth)*100).toFixed(4)}%`;
           sliderHandle.style.left=`calc(${((mouseX/sliderWidth)*100).toFixed(4)}% - ${sliderHandleWidth/2}px)`;
       }

    let isSliderLocked=false;

    slider.addEventListener("mousedown", sliderMouseDown);
    slider.addEventListener("touchstart", sliderMouseDown);
    slider.addEventListener("mouseup", sliderMouseUp);
    slider.addEventListener("touchend", sliderMouseUp);
    slider.addEventListener("mouseleave", sliderMouseLeave);

        function sliderMouseDown(event) {
                 if (isSliderLocked) isSliderLocked=false;
                 sliderMouseMove(event);

         }

    function sliderMouseUp() {
        if (!isSliderLocked) isSliderLocked = true;
    }
    //se tolgo questo diventa click muovi e basta
     function   sliderMouseLeave() {
     
         if (isSliderLocked) isSliderLocked=false;
     }

    </script>
    <script>
        function syncHeaderHeight() {
            const header = document.querySelector('.main-header');
            if (!header) return;
            document.documentElement.style.setProperty('--header-h', header.offsetHeight + 'px');
        }

        window.addEventListener('load', syncHeaderHeight);
        window.addEventListener('resize', syncHeaderHeight);
    </script>

}
